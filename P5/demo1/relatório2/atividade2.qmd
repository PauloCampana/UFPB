---
format: pdf
---

```{r}
# Classificação da estrutura etária segundo Sundbarg e
# Whipple (2000 e 2010)
```

```{r}
#| fig-cap: Pirâmide Etária segundo situação do domicílio nos censos de 2000 e 2010
#| fig-width: 6.25
#| fig-height: 8

# Fazer a Pirâmide Etária para o total, rural e urbano
# (censo 2000 e 2010).

df2000[-(1:20), ] |> 
    rbind(df2010[-(1:20), ]) |> 
    pivot_longer(
        -c(ano, idade),
        names_to = c("domicilio", "sexo"),
        names_sep = "_"
    ) |> 
    pivot_wider(
        names_from = sexo
    ) |> 
    mutate(
        idade = as.integer(str_extract(idade, "\\d*")),
        domicilio = str_to_sentence(domicilio),
        domicilio = fct_relevel(domicilio, "Rural", "Urbano", "Total")
    ) |> 
    ggplot(aes(y = idade, xmin = 0)) +
    facet_grid(vars(domicilio), vars(ano)) +
    geom_linerange(aes(xmax = -homens), linewidth = 1, color = "#6080f0") +
    geom_linerange(aes(xmax = mulheres), linewidth = 1, color = "#f06080") +
    annotate("text", x = -125000, y = 100, label = "Homens") +
    annotate("text", x = +125000, y = 100, label = "Mulheres") +
    scale_x_continuous(
        name = "População",
        labels = \(x) format(abs(x), scientific = FALSE, big.mark = " ")
    ) +
    scale_y_continuous(
        name = "Idade",
        n.breaks = 11
    ) +
    theme_bw()
```


